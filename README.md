# 项目编译

## 编译
1. 确保已安装CMake和C++编译器
2.  在根目录下运行build_project脚本：./build_project.bat
3.  可执行文件将生成在bin目录下


# 测试 
目前仅使用了google test框架，未来可能引入更多
## Google Test

### 部署方式
1. cd lib/googletest
2. mkdir build
3. cd build
4. cmake ..
5. cmake --build .

当前我是已经部署成功，但是可能会出现我本地的构造无法适配其他机器的构造，下面介绍解决方法
### 部署方式
1. 删除lib目录里的googletest，使用以下指令重新构建项目：
    #### 在项目根目录下执行
    git clone https://github.com/google/googletest.git lib/googletest
    cd lib/googletest
    mkdir build
    cd build
    cmake ..
    cmake --build .


# 项目输出
项目的输出将在bin目录下生成可执行文件，项目可执行文件名为backup_app.exe， 测试可执行文件名为test_app.exe。
*注意*： 项目可执行文件的入口是src/main.cpp，而测试可执行文件的入口是test/test_main.cpp，所以如果要进行改动的话需要找对文件，测试文件的输出结果会出现一个说明表格。

# 可能问题
Q：还原是不是可以指定还原路径比较好？
A：

# TODO:
10.28:
1. 修改backup和recover的逻辑，当前逻辑无法满足将对应目录结构还原的需求，需要对备份功能、还原功能、打包功能进行修改
2. 具体修改为：1、将备份对象定义为一个struct，其中加上类型属性。2、打包时同样需要记录对应的类型属性。3、还原时需要根据不同的类型进行对应的还原操作。
-[ ] 增加备份对象结构体  (不用了，实际上还是打包的问题)
-[x] 修改对应备份、还原逻辑
-[x] 修改打包对象
-[x] 修改打包和解包对应逻辑
遗留问题：
- [x]  打包正常，还原出现内存分配问题，后续出现路径问题，需要将main函数中的调用相关代码进行修改

10.29后计划：
TODO:
-[x] 加密解密功能实现
-[x] 增加还原的备份选择功能，具体期望是在还原前可以展示备份记录，当选择对应文件名时会将该文件的备份记录都展示出来供选择
-[] 将当前功能做成接口方便UI设计的调用

# TODO  -->  BUG:
-[x] 正常copy，还原时候的记录文件名存在问题
-[x] 记录精确到秒
-[x] 备份的时候加入一个描述，后续记录可以显示

# 版本
| 版本 | 日期 | 说明 |
| --- | --- | --- |
| 0.1 | 2025-09-26 | 完成基本框架搭建，为项目添加了google test框架 |
| 0.2 | 2025-09-27 | 完成了最基本的备份功能，同时为了方便后续的还原功能的开发，增设备份记录类，并成功通过测试（同时增加了json的外部库）(这里因为还是在实现基础功能，就没有开新的分支) |
| 0.3 | 2025-10-07 | 备份功能的完善，还原功能的实现，编译后运行生成的backup_app.exe程序，命令行操作进行备份和还原。进行备份时使用--mode backup --src "源路径" --dst "备份仓库相对路径"，可选添加--include "正则表达式"来筛选特定类型的文件。恢复时使用--mode recover --dst "备份仓库相对路径" --to "目标还原路径"命令。可通过--repo "路径"命令设置备份仓库位置|
| 0.4 | 2025-10-11 | 实现了基本的打包和解包算法，接下来将进一步结合压缩进行实现|
|0.5 | 2025-10-21 | 集成了压缩功能，目前仅支持huffman压缩算法，压缩已经通过googletest单元测试验证成功，只需要在命令行加上--compress <compressType（目前只支持Huffman）>,但是打包是否可以还原目录需要等待进一步测试(还原之后目前的设定是保留最初的备份文件，形成的中间文件都被删掉),但是现在有一个问题，就是假设一个文件夹有多个备份，还原操作会都还原并且进行覆盖，后续需要修改一下，还是针对备份记录来还原或许会好一点|
| 0.6 | 2025-10-29 | 这次是一次大完善，将之前的备份设计给重新设计了一遍。当前备份支持目录文件的整个目录结构的还原，同时加入了备份记录的功能，但是目前还没有拓展到可以选择，这里是将原先的指令进行了简单的修改：--mode recover --dst “需要还原的备份文件原文件名（这里暂时不支持选择，默认选择记录中该文件名记录的第一项）”  --to  “想要还原到的目录（不再是强制还原到原先的路径，后续也可以设置这个参数为默认原先路径，只是需要确认一下目录等信息）”  当备份或还原完成后，在对应的备份仓库会有一个json文件，存储记录相关的备份记录  *注意：我将json的路径发在了lib里面，需要clone到lib文件夹后才能编译项目！！！* |
| 0.7 | 2025-11-03 | 本次主要新增了加密功能，通过简单的异或实现对称加密，当解压时需要输入正确的密钥才能解密，随后对还原功能进行了更新，当需要还原的文件存在多个备份记录时，会展示所有的备份记录供用户进行使用；另外，因为不同算法头结构不同，结构的重复命名是原先设计的缺陷，后面需要想办法重新设计一下  *注意：之前全部以1作为是否打包、压缩、加密的标识，这个显然是不合理的，现在三个分别是0x01 0x21 0x31* |
| 1.0 | 2025-12-7 | 本次主要是完成了之前测试提及的三个BUG的修复，主要是通过额外增加时间戳目录避免直接复制造成的文件覆盖，通过增加文件描述来保证不同备份记录之间的可区分性 |